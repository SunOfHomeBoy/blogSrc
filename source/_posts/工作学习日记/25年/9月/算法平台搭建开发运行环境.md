<!--
 * @Description: 运行图像符合检测模型
 * @Date: 2025-09-09 10:30:05
 * @LastEditTime: 2025-09-10 09:51:22
 * @FilePath: \videoFrameCalc\Code\PictureAlgorithm\prompt.md
-->
# 根据[Readme](README.MD) 创建conda环境&安装依赖
  ```bash
    # 1. 创建conda环境
    conda create -n PA python=3.8.18 -y
      Downloading and Extracting Packages:

      Preparing transaction: done
      Verifying transaction: done
      Executing transaction: done
      #
      # To activate this environment, use
      #
      #     $ conda activate PA
      #
      # To deactivate an active environment, use // 要停用活动环境，请使用
      #
      #     $ conda deactivate // 停用活动环境

    # 2. 进入conda环境
    conda activate PA

    # 3. 安装核心依赖（PyTorch、TensorRT）​​
    # PyTorch 1.12.0+cu116 和 TensorRT 8.6.0 需严格匹配 CUDA 11.6，通过 conda安装可确保 CUDA 工具链兼容：

    # 安装 PyTorch 1.12.0 + CUDA 11.6（来自 pytorch 官方通道）
    conda install -c pytorch pytorch=1.12.0 cudatoolkit=11.6 -y

    # 安装 TensorRT 8.6.0（来自 nvidia 通道，匹配 CUDA 11.6）
    conda install -c nvidia tensorrt=8.6.0 -y

    #•​​注意​​：若 nvidia通道未添加，需先执行
    conda config --add channels nvidia

    # 3.1 安装核心依赖（PyTorch、TensorRT）​​使用 潘鹏提供包(官网下载)
    # [包路径](/mnt/e/Project/videoFrameCalc/Code/PA项目Ubuntu系统环境依赖)
    torch-1.12.0+cu116-cp38-cp38-linux_x86_64.whl  
    torchaudio-0.12.0+cu116-cp38-cp38-linux_x86_64.whl
    torchvision-0.13.0+cu116-cp38-cp38-linux_x86_64.whl

    # 4. 安装 Flask 和 Gunicorn（通过 pip）​​
    # Flask 3.0.3 和 Gunicorn 建议通过 pip安装（Conda 仓库可能无最新小版本）：
    pip install flask==3.0.3 gunicorn -y

    # ​5. 安装其他依赖（requirements.txt）​​
    # 若项目有额外的依赖（如 requirements.txt中列出的包），最后通过 pip统一安装：
    pip install -r requirements.txt

    # 补充安装
    # 步骤 1：安装 nvidia-pyindex（NVIDIA 包索引工具）​​
    # nvidia-pyindex是 NVIDIA 提供的 PyPI 索引插件，用于让 pip 识别 NVIDIA 托管的包。执行以下命令安装：
    pip install nvidia-pyindex

    # 步骤 2：安装 graphsurgeon（从 NVIDIA 索引获取）​​
    # 安装完 nvidia-pyindex后，pip 会自动识别 NVIDIA 的包索引。再次执行安装命令（或继续执行 pip install -r requirements.txt）：
    pip install graphsurgeon
  ```

  ## 验证安装​
    安装完成后，可通过以下命令验证关键包版本是否符合要求：
  ```bash
    # 验证 Python 版本
    python --version  # 应输出 Python 3.8.18

    # 验证 PyTorch 版本及 CUDA 支持
    python -c "import torch; print(torch.__version__); print(torch.version.cuda)"  # 应输出 1.12.0 和 11.6
    # (PA) lishichen@DESKTOP-0M2EPFH:/mnt/e/Project/videoFrameCalc/Code/PictureAlgorithm$ python -c "import torch; print(torch.__version__); print(torch.version.cuda)"  # 应输出 1.12.0 和 11.6
    1.12.0+cu116
    11.6

    # 验证 TensorRT 版本
    python -c "import tensorrt; print(tensorrt.__version__)"  # 应输出 8.6.0
    10.13.3.9

    # 验证 Flask 版本
    python -c "import flask; print(flask.__version__)"  # 应输出 3.0.3
    3.0.3
  ```

  ### 注意事项​​
    1. ​​CUDA 驱动兼容性​​：确保服务器已安装 ​​CUDA 11.6 驱动​​（与 cudatoolkit=11.6匹配），否则 PyTorch/TensorRT 可能无法正常运行。
    2. ​​TensorRT 安装问题​​：若 conda install tensorrt=8.6.0失败（如通道无该版本），可从 [NVIDIA TensorRT 官网](https://developer.nvidia.com/tensorrt)下载对应版本的 tar包手动安装（需匹配 CUDA 11.6）。
    3. ​​Gunicorn 启动命令​​：部署时使用用户提到的多进程启动命令：
      ```bash
        # 确保 recive_file.py中定义了 app对象，且路径正确
        gunicorn -w 10 -b 0.0.0.0:5001 recive_file:app
      ```

    + ​​总结​​
      通过以上步骤，可快速搭建兼容 ​​二级平台复合算法 v1.0​​ 的 Conda 环境，确保 PyTorch、TensorRT 等核心依赖的版本和 CUDA 环境严格匹配，同时通过 pip补充通用包的安装需求。

  ## 项目启动
    > python recive_file.py

    + 生成环境部署
    > gunicorn -w 10 -b 0.0.0.0:5001 recive_file:app
