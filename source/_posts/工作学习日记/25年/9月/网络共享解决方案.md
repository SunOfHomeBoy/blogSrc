# 网络共享解决方案

## 问题描述

1. 我通过 阿里云 服务 frp 实现了内网穿透，可以访问外网。
2. 然后我在能访问外网的 win系统跳板机上 通过 frp 暴露了 局域网中的 Ubuntu 服务器 10.189.230.22:22 IP:端口
3. 这样我就在本机通过 阿里云IP:端口 访问了 Ubuntu 10.189.230.22:22 的局域网服务器。
4. 现在 我希望 把 win跳板机 的外网访问能力，共享给 10.189.230.22 的局域网服务器。

## 解决方案

### 方案一：配置 FRP 反向代理（推荐）

最直接的方法是配置 FRP 实现双向通信：

1. 您已经配置了 FRP 将 SSH 访问转发到 Ubuntu 服务器
2. 您也可以配置 Windows 跳板机上的 FRP，让 Ubuntu 服务器能够访问互联网

这需要修改您的 FRP 配置来添加反向代理设置。

### 方案二：Windows 网络连接共享

您可以在 Windows 跳板机上启用网络连接共享：

1. 打开网络连接 (ncpa.cpl)
2. 右键点击具有互联网访问权限的网络适配器
3. 选择属性 > 共享选项卡
4. 勾选"允许其他网络用户通过此计算机的 Internet 连接来连接"
5. 在下拉菜单中，选择连接到本地网络的网络适配器（Ubuntu 服务器所在的网络）

### 方案三：在 Windows 上配置路由和 NAT

如果您更喜欢技术性方法：

1. 在 Windows 上启用 IP 转发：
   ```
   # 以管理员身份运行命令提示符
   reg add HKLM\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters /v IPEnableRouter /d 1 /t REG_DWORD
   ```

2. 使用 netsh 配置 NAT：
   ```
   netsh routing ip nat install
   netsh routing ip nat add interface "本地网络接口"
   netsh routing ip nat set interface "互联网接口" mode=full
   ```

### 方案四：使用 FRP 设置 SOCKS 代理

您可以配置 FRP 创建 SOCKS5 代理：

1. 在 Windows 上的 FRP 客户端配置中添加：
   ```ini
   [socks5_proxy]
   type = tcp
   remote_port = 1080
   plugin = socks5
   ```

2. 在 Ubuntu 服务器上，配置系统代理设置以使用 Windows 主机作为 SOCKS 代理：
   ```bash
   export ALL_PROXY=socks5://<windows-local-ip>:1080
   ```

## 建议

对于您的使用场景，推荐使用方案一（FRP 反向代理）或方案四（SOCKS 代理），因为这些方法与您现有的 FRP 设置最为兼容，并且不需要对 Windows 系统进行重大更改。